# Модуль функций виртуального мира для Unity3D.
Данный модуль позволяет создавать и управлять объектами в виртуальном мире Визуализатора на Unity3D.<br>

В конфигурационном файле модуля (config.ini в папке модуля) указывается ip-адрес компьютера на котором запущен Визуализатор и порт для подключения к нему.

*Пример содержимого конфигурационного файла:*
```ini
    [connection]
    ip = 192.168.1.124
    port = 12000
```

####Доступные функции:
Определение  | Описание 
------------  | ----------------- 
createWorld(**x**, **y**, **z**)	| Создает рабочую область(мир) в визуализаторе с соответствующими границами. 
destroyWorld()	| Уничтожает рабочую область(мир).
deleteObject(**obj_id**)	|  Удаляет объект с заданным **object_id**.
createCube(**x**, **y**, **z**, **dx**, **dy**, **dz**, **angle**, **hold**, **color**)	| Создает куб цвета **color** в координатах **x**,**y**,**z** длиной шириной и высотой в **dx**,**dy**,**dz**. Угол поворота объекта вдоль собственной вертикальной оси равен **angle**. При **hold**=0 объект получает статус не удерживаемого, при **hold**=1 объект получает статус удерживаемого. Возвращает **object_id** созданного объекта.
createSphere(**x**, **y**, **z**, **R**, **hold**, **color**)	| Создает сферу цвета **color** с цетром в координатах **x**,**y**,**z** радиуса **R**. При **hold**=0 объект получает статус не удерживаемого, при **hold**=1 объект получает статус удерживаемого. Возвращает **object_id** созданного объекта.
createModel(**x**, **y**, **z**, **scale_x**, **scale_y**, **scale_z**, **angle**, **hold**, **color**, **path**)	| Создает заранее подготовленную 3d модель, находящуюся по указанному пути **path**, цвета **color** в координатах **x**,**y**,**z**. Масштаб модели задается через **scale_x**, **scale_y**, **scale_z**, угол поворота вдоль собственной вертикальной оси равен **angle**. При **hold**=0 объект получает статус не удерживаемого, при **hold**=1 объект получает статус удерживаемого. Возвращает **object_id** созданного объекта.
changeColor(**obj_id**, **color**)	| Изменение цвета объекта **obj_id** на цвет **color**.;
moveObject(**obj_id**, **x**, **y**, **z**, **angle**, **speed_coord**, **speed_angular**)	| Перемещение объекта **obj_id** в точку с координатами **x**,**y**,**z** со скоростью **speed_coord** и переход d положение с углом поворота **angle** со скоростью **speed_angular**.
changeStatus(**obj_id**, **hold**)	| Изменение статуса(*удерживаемый/не удерживаемый*) объекта **obj_id** на статус задаваемый переменной **hold**.
getX(**obj_id**)	| Возвращает координату **X** объекта.
getY(**obj_id**)	| Возвращает координату **Y** объекта.
getZ(**obj_id**)	| Возвращает координату **Z** объекта.
getAngle(**obj_id**)	| Возвращает угол поворота **angle** объекта.

#####Примечания:
Переменная **color** должна принимать строковое значение цвета в HEX формате (три пары шестнадцатеричных цифр 0-F: FFAA00, BBEE33, и пр.).<br>


Если объект при появлении не пересекается с каким-либо другим объектом, то в зависимости от параметра **hold** для него выполняется проверка стабильности.<br>
 - Если параметр **hold** равен 0, то объект получает статус **"не удерживаемого"**, для данного объекта сразу же после появления выполняется проверка стабильности, которая считается успешно пройденной, если под действием физических сил объект не меняет положения и позиции как своих, так и других объектов.<br>
 - Если параметр **hold** равен 1, то объект получает статус **"удерживаемого"** и проверки стабильности для него не выполняется.<br>

В переменной **path** функции createModel() задается путь до файла с 3D моделью относительно каталога для 3D моделей, адрес которого задается в конфигурационном файле для Визуализатора. <br>
Пример пути до файла модели:<br>
 ```
 /home/workspace/visualisator/Linux/  - путь до каталога с 3d моделями
 	scenes/
 		...
 	Linux
 	Linux.manifest
 	robot ---------------- имя интересующей нас модели.
 	robot.manifest
```
Тогда переменная **path** функции createModel() должна иметь значение **path**="robot"


####Создание модели для загрузки виртуальным модулем
- Модель должна быть создана в Unity3D или импортирована в него из другой программы трёхмерного моделирования. [Список поддерживаемых форматов](http://docs.Unity3D.com/ru/current/Manual/HOWTO-importObject.html).<br>
- Если модель импортирована в Unity3D  из другой программы, то для корректной работы визуализатора к ней необходимо добавить компонент **"Box Collider"**: выбираем модель и в инспекторе(Inspector) **Add Component->Physics->"Box Collider"**.
- Далее с помошью Unity3D модель должна быть преобразована в [AssetBundle](http://docs.Unity3D.com/ru/current/Manual/abfaq.html). Для создания AssetBundle Unity3D проект должен иметь специальный скрипт. Можно воспользоватся готовым скриптом для Unity3D [AssetBundlesBuilder](), либо создать его [самому](http://docs.unity3d.com/ru/current/Manual/BuildingAssetBundles5x.html). <br>
- Например при использовании *AssetBundlesBuilder* на панели инструментов появляется новый пункт **"AssetBundles"**. В котором можно отметить для какой системы мы собираем AssetBundle и при выборе пункта **"Build Asset Bundles"** будут собраны объявленные AssetBundles.
- Чтобы объявить Asset Bundle необходимо выбрать ассет(модель) в Unity3D во вкладке Проект. В правом нижнем углу появится превью ассета(модели) и внизу окна превью находится пункт AssetBundle. 
- При нажатии на AssetBundle появится выпадающее меню, пункт new позволяет объявить новый Asset Bundle.
- Теперь при применении **"Build Asset Bundles"** будет создаваться Asset Bundle включающий выбранный ассет(модель).


Пример создания AssetBundles в **AssetBundlesBuilder**:
- Создаем в unity объект куб: во вкладке Hierarchy, **Create->3D Object->Cube**.
- Перемещаем его из вкладки Иерархия на вкладку Проект к дркгим ассетам. Теперь у нас создан [префаб(prefab)](http://docs.unity3d.com/ru/current/Manual/Prefabs.html) этого куба.
- При выборе префаба в правом нижнем углу появляется появляется его превью и пункт AssetBundles.
- Нажимаем **AssetBundles->New**. Вводим название нового Asset Bundle. Например вводим "robot".
- Теперь на панели инструментов: выбираем **"AssetBundles"**->**"Build for Win"**, затем **"AssetBundles"**->**"Build Asset Bundles"**.
- В указанный путь собирается наш Asset Bundle. Например мы создаем его в папку "Bundle_1".


Если мы собирали под windows, то папка с Asset Bundle будет выглядеть так:
```
 .../Bundle_1/
 	Win             --- Главный ассет для работы с соответствующей платформой,
 						его имя необходимо задать в конфигурационном файле визуализатора.
 	Win.manifest
 	robot           --- Модель.
 	robot.manifest
```

#### Вид конфигурационного файла Визуализатора:
```
12000									  --- Порт для подключения
file:///d:/TempU3D/AssetBundle/Cube/Win/  --- Путь до папки с 3D моделями
Win                                       --- Имя главного ассета для работы с соответствующей платформой
```

####Компиляция
Для компиляции модуля потребуются следующие библиотеки:
- [SimpleIni](https://github.com/brofield/simpleini)
- [Boost](http://www.boost.org/)
